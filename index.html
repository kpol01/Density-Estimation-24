<!DOCTYPE html>
<html lang="en"><head>
<script src="density_estimation (2)_files/libs/clipboard/clipboard.min.js"></script>
<script src="density_estimation (2)_files/libs/quarto-html/tabby.min.js"></script>
<script src="density_estimation (2)_files/libs/quarto-html/popper.min.js"></script>
<script src="density_estimation (2)_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="density_estimation (2)_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="density_estimation (2)_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="density_estimation (2)_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="density_estimation (2)_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Kaustav Paul   Shreya Chatterjee   Ananyo Dey">
  <title>Density Estimation</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="density_estimation (2)_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="density_estimation (2)_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="density_estimation (2)_files/libs/revealjs/dist/theme/quarto.css">
  <link href="density_estimation (2)_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="density_estimation (2)_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="density_estimation (2)_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="density_estimation (2)_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Density Estimation</h1>
  <p class="subtitle">Histograms, Asymptotics, Crossvalidation</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Kaustav Paul <br> Shreya Chatterjee <br> Ananyo Dey 
</div>
        <p class="quarto-title-affiliation">
            Indian Statistical Institute, Delhi Center
          </p>
    </div>
</div>

</section>
<section id="introduction" class="slide level2 scrollable">
<h2>Introduction</h2>
<ul>
<li class="fragment"><p><em>Probability density function</em> is one of the vital and fundamental concept in statistics. Consider any random quantity <span class="math inline">\(X\)</span> that has a unique probability density function <span class="math inline">\(f\)</span>. Guessing or knowing the <span class="math inline">\(f\)</span> is one of the important aspects for the statistician to infer about the population. It allows probabilities associated the <span class="math inline">\(X\)</span> to be found from the relation <span class="math display">\[P(a &lt; X &lt; b) = \int_{a}^{b} f(x) dx \hspace{2mm} \text{for all} \hspace{2mm} a &lt; b \]</span></p></li>
<li class="fragment"><p>One way of guessing about the <span class="math inline">\(f\)</span> is via parametric method. In this method we assume <span class="math inline">\(f\)</span> is a member of known parametric family of distribution and based on the observed data we are trying to estimate the parameters of the assuming parametric form.</p></li>
<li class="fragment"><p>Here we are focusing on the non-parametric approach with less rigid assumptions will be made about the distribution of the observed data.</p></li>
<li class="fragment"><p>Density estimation methods as we know them today began during the 1950s. However, in spirit it has been studied even via the Greeks via histograms.</p></li>
</ul>
</section>
<section id="estimators" class="title-slide slide level1 center">
<h1>Estimators</h1>
<ul>
<li class="fragment"><p>We have to estimate density function <span class="math inline">\(f\)</span>. But there does not exist any non-negative unbiased estimator of <span class="math inline">\(f\)</span>. So all the estimators should be biased.</p></li>
<li class="fragment"><p>The very intuitive idea for estimating <span class="math inline">\(f\)</span> will be using histogram. For the presentation and exploration of data, histograms are of course an extremely useful class of density estimates, particularly in the <em>univariate case.</em></p></li>
<li class="fragment"><p>Suppose <span class="math inline">\(X_1, X_2, X_3, \cdots, X_n\)</span> are iid <span class="math inline">\(f(x)\)</span> where <span class="math inline">\(f(x)\)</span> is completely unknown.</p></li>
<li class="fragment"><p> Fix a point <span class="math inline">\(x_0\)</span> and a bin width <span class="math inline">\(h\)</span> . Consider histogram on the intervals <span class="math inline">\([x_0 + mh, x_0 + (m+1)h)\)</span> where <span class="math inline">\(m = 0, \pm 1, \pm 2, \pm 3, \cdots\)</span> . Estimators of <span class="math inline">\(f(x)\)</span> = <span class="math inline">\(\frac{1}{n h} \text{No. of} \hspace{1mm} X\text{'s in the same bin as} \hspace{1mm} x\)</span></p></li>
</ul>
</section>

<section id="estimators-1" class="title-slide slide level1 center">
<h1>Estimators</h1>
<ul>
<li class="fragment"><p>To construct that histogram, we have to choose both an origin and a bin width. Note, choosing the bin width primarily inherent the amount of smoothing.</p></li>
<li class="fragment"><p>From this estimators we can observe that if <span class="math inline">\(n\)</span> increases no. of <span class="math inline">\(X\)</span>’s in the same bin as <span class="math inline">\(x\)</span> increases.</p></li>
<li class="fragment"><p>Let see some examples using simulation how the sample origin, bin width and sample size effects.</p></li>
</ul>
</section>

<section>
<section id="effects-on-histogram" class="title-slide slide level1 center">
<h1>Effects on Histogram</h1>

</section>
<section id="effect-of-origin-x_0-on-histogram" class="slide level2">
<h2>Effect of Origin (<span class="math inline">\(x_0\)</span>) on Histogram</h2>
<div class="cell" data-fig.dim="[15,7]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Arrange the plots in a 4x4 grid</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="at">grobs =</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">17</span>), <span class="cf">function</span>(i) {</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="fu">arrangeGrob</span>(<span class="at">grobs =</span> Allplots[i<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">3</span>)],<span class="at">top =</span> col_titles[(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>], <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>  }),</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">top=</span> <span class="fu">text_grob</span>(<span class="st">"Effect of Origin"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-2-1.png" width="1440" class="r-stretch"></section>
<section class="slide level2">

<h3 id="effect-of-fixed-bin-width-h-on-histogram">Effect of Fixed bin width (h) on Histogram</h3>
<div class="cell" data-fig.dim="[15,7]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Arrange the plots in a 4x4 grid</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="at">grobs =</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">17</span>), <span class="cf">function</span>(i) {</span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="fu">arrangeGrob</span>(<span class="at">grobs =</span> Allplots[i<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">3</span>)],<span class="at">top =</span> col_titles[(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>], <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>  }),</span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">top=</span> <span class="fu">text_grob</span>(<span class="st">"Effect of fixed binwidth"</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-4-1.png" width="1440" class="r-stretch"></section>
<section class="slide level2">

<h3 id="effect-of-sample-size-n-on-histogram">Effect of Sample size (n) on Histogram</h3>
<div class="cell" data-fig.dim="[15,7]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Arrange the plots in a 4x4 grid</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="at">grobs =</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>,<span class="dv">17</span>), <span class="cf">function</span>(i) {</span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="fu">arrangeGrob</span>(<span class="at">grobs =</span> Allplots[i<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">3</span>)],<span class="at">top =</span> col_titles[(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>], <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>  }),</span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="at">ncol =</span> <span class="dv">5</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-6-1.png" width="1440" class="r-stretch"></section></section>
<section id="estimators-2" class="title-slide slide level1 center">
<h1>Estimators</h1>
<ul>
<li class="fragment"><p>Histogram can be generalized by allowing bandwidths to vary. So here we consider the varying bandwidth. This varying binwidth could be decided prior or be data depended. We can estimate density by: <span class="math display">\[\hat{f_2(x)} = \frac{1}{n} \frac{\text{No. of X's in the same bin as x}}{\text{width of the bin}}\]</span></p></li>
<li class="fragment"><p>Lets see how it goes via simulation</p></li>
</ul>
</section>

<section>
<section id="effects-on-histograms" class="title-slide slide level1 center">
<h1>Effects on Histograms</h1>

</section>
<section class="slide level2">

<h3 id="effects-of-varying-width-on-histogram">Effects of varying width on Histogram</h3>
<div class="cell" data-fig.dim="[15,7]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Arrange the plots in a 4x5 grid</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="at">grobs =</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">17</span>), <span class="cf">function</span>(i) {</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="fu">arrangeGrob</span>(<span class="at">grobs =</span> Allplots[i<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">3</span>)],<span class="at">top =</span> col_titles[(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>], <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>  }),</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="at">ncol =</span> <span class="dv">5</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-8-1.png" width="1440" class="r-stretch"></section>
<section class="slide level2">

<h3 id="comments">Comments</h3>
<ul>
<li class="fragment"><p>For the origin shifting guessing wrong origin leads to wrong interpretation about the distribution.</p></li>
<li class="fragment"><p>For the bandwidth, as it is decreasing the amount of precision is increasing.</p></li>
<li class="fragment"><p>As the sample size increases the histogram almost coincides with the <em>TRUE</em> density function.</p></li>
<li class="fragment"><p>For the varying bandwidth with, as we are going far from the mode value we are taking less bandwidth and that works well and gives us a good fit.</p></li>
<li class="fragment"><p>If you have a large sample size then the Histogram has nice precision.</p></li>
</ul>
</section></section>
<section>
<section id="kernel-density-estimation-its-asymptotics" class="title-slide slide level1 center">
<h1>Kernel Density Estimation &amp; its Asymptotics</h1>

</section>
<section id="background-theory" class="slide level2">
<h2>Background Theory</h2>
<p>Kernel type Estimator: Consider the class of estimators of the form, <span class="math display">\[f_n(x) = \frac{1}{nh_n} \sum_{i=1}^n k(\frac{x-X_i}{h_n})\]</span> where <span class="math inline">\(h_n \rightarrow 0\)</span> and <span class="math inline">\(n \rightarrow \infty\)</span> and <span class="math inline">\(K\)</span> is a suitable density function, i.e., <span class="math inline">\(A_1:\)</span> sup <span class="math inline">\(\{k(x) : x \in \mathbb{R}\} \leq M\)</span>, <span class="math inline">\(|x|k(x) \rightarrow 0\)</span> as <span class="math inline">\(|x| \rightarrow \infty\)</span> and <span class="math inline">\(A_2:\)</span><span class="math inline">\(k(x) = k(-x) \hspace{2mm} \forall x\)</span> <span class="math inline">\(\int_{-\infty}^{\infty} x^2 k(x) dx &lt; \infty\)</span></p>
<p>Now applying the large sample theory, Under some regularity condition, <span class="math display">\[\frac{f_n(x) - \mathbb{E}(f_n(x))}{\sqrt{Var(f_n(x))}} \xrightarrow[]{\mathcal{D}} N(0,1)\]</span> as <span class="math inline">\(n \rightarrow \infty\)</span> Note: <span class="math inline">\(\mathbb{E}(f_n(x)) = \frac{1}{h_n} \int_{-\infty}^{\infty} k(\frac{x-y}{h_n}) f(y) dy\)</span> and var<span class="math inline">\((f_n(x)) \approx \frac{1}{h_n} f(x) \int_{-\infty}^{\infty} k^2(z) dz\)</span></p>
</section>
<section id="background-theory-1" class="slide level2">
<h2>Background Theory</h2>
<p>Moreover if we assume that - <span class="math inline">\(K(x)\)</span> is a symmetric bounded density function &amp; - <span class="math inline">\(\int_{-\infty}^{\infty} y^2 K(y) d(y) = 1\)</span></p>
<p>then we can approximate the asymptotic mean and variance of <span class="math inline">\(f_n(x)\)</span> as follows;</p>
<span class="math display">\[\begin{align}
  \mathbb{E}[f_ n(x)] &amp;\approx f(x) + \frac{1}{2}f^{(2)}(x)h^2_n \\
  Var[f_n(x)] &amp;\approx \frac{1}{nh_n} f(x) \int_{-\infty}^{\infty} K^2(y) dy
  
\end{align}\]</span>
<p><strong>Note:</strong> The asymptotic convergence mentioned earlier is point wise not uniform with respect to <span class="math inline">\(x\)</span>.</p>
</section>
<section id="examples" class="slide level2">
<h2>Examples</h2>
<p>Sample from Normal(0,1) with bandwidth <span class="math inline">\(h_n = n^{(-0.2)}\)</span></p>
<p>We have simulated 1000 values of estimated density using <em>Gaussian Kernel</em> taking <span class="math inline">\(x\)</span> as the 60th percentile, standardized them and obtained the following histogram.</p>

<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="checking-point-wise-convergence" class="slide level2">
<h2>Checking point-wise Convergence</h2>
<h4 id="points-to-be-noted">Points to be noted</h4>
<div>
<ul>
<li class="fragment">The asymptotic convergence does not hold uniformly but in a point-wise sense.</li>
<li class="fragment">The rate of convergence may vary with the chosen <span class="math inline">\(x\)</span> where we want to estimate the density.</li>
<li class="fragment">Usually the cluster of points at the tail-end of the distribution is much less, so estimating density at the tail end points may not yield satisfactory</li>
</ul>
</div>
</section>
<section id="checking-point-wise-convergence-1" class="slide level2 scrollable">
<h2>Checking point-wise Convergence</h2>
<p>Samples from N(0,1), with <em>Gaussian kernel</em>, taking <span class="math inline">\(h_n = n^{-0.2}\)</span>, we have considered the quantiles 0.5, 0.65, 0.8, 0.9</p>

<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="checking-point-wise-convergence-2" class="slide level2 scrollable">
<h2>Checking point-wise Convergence</h2>
<p>Samples from Exponential(1), with <em>Epanechnikov kernel</em>, taking <span class="math inline">\(h_n = n^{-0.2}\)</span>, we have considered the quantiles 0.5, 0.65, 0.8, 0.9</p>

<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="checking-point-wise-convergence-3" class="slide level2">
<h2>Checking point-wise Convergence</h2>
<h4 id="observations-from-the-histograms">Observations from the histograms</h4>
<div>
<ul>
<li class="fragment">As <span class="math inline">\(n\)</span> increases the shape of the histograms tend coincide with the density of <span class="math inline">\(N(0,1)\)</span>.</li>
<li class="fragment">However the rate of convergence to Normal is faster for the moderate quantiles.</li>
<li class="fragment">As we try to estimate the densities at the tail end, we are not getting as fast convergence as in the moderate quantiles.</li>
<li class="fragment">For Exponential case there is a shift of the histograms to the left even at <span class="math inline">\(n = 750\)</span></li>
</ul>
</div>
</section>
<section id="inter-play-between-n-and-h_n" class="slide level2">
<h2>Inter-play between <span class="math inline">\(n\)</span> and <span class="math inline">\(h_n\)</span></h2>
<h4 id="points-to-be-noted-1">Points to be noted</h4>
<div>
<ul>
<li class="fragment">With decrease in <span class="math inline">\(h_n\)</span> the variation in the estimated density increases.</li>
<li class="fragment">The asymptotic variance of <span class="math inline">\(f_n(x)\)</span> is of order <span class="math inline">\(\frac{1}{nh_n}\)</span>, hence <span class="math inline">\(\sqrt{nh_n}\)</span> is the right scaling factor for <span class="math inline">\((f_n(x) - f(x))\)</span>.</li>
<li class="fragment">For asymptotic results to hold we need <span class="math inline">\(h_n \rightarrow 0\)</span> and <span class="math inline">\(nh_n \rightarrow \infty\)</span></li>
<li class="fragment">To achieve normality we not only need <span class="math inline">\(n\)</span> to be large but <span class="math inline">\(nh_n\)</span> to be large as well.</li>
<li class="fragment">So depending on the choice of <span class="math inline">\(n\)</span> we need to choose <span class="math inline">\(h_n\)</span>. Hence <span class="math inline">\(h_n\)</span> also plays a role in the asymptotic behaviour of <span class="math inline">\(f_n(x)\)</span>.</li>
</ul>
</div>
</section>
<section id="inter-play-between-n-and-h_n-1" class="slide level2 scrollable">
<h2>Inter-play between <span class="math inline">\(n\)</span> and <span class="math inline">\(h_n\)</span></h2>
<h4 id="samples-from-n01-with-gaussian-kernel-taking-h_n-n-0.1-n-0.2-n-0.3-n-0.4">Samples from N(0,1), with <em>Gaussian kernel</em>, taking <span class="math inline">\(h_n = n^{-0.1}, n^{-0.2}, n^{-0.3}, n^{-0.4}\)</span></h4>
<div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-16-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="inter-play-between-n-and-h_n-2" class="slide level2">
<h2>Inter-play between <span class="math inline">\(n\)</span> and <span class="math inline">\(h_n\)</span></h2>
<h4 id="observations">Observations</h4>
<div>
<ul>
<li class="fragment">For large <span class="math inline">\(n\)</span> asymptotic normality is being attained at relative large order of <span class="math inline">\(h_n\)</span>.</li>
<li class="fragment">For <span class="math inline">\(n = 20\)</span>, even <span class="math inline">\(h_n = n ^{-0.4}\)</span> there are some disturbances with the peak of the histograms.</li>
<li class="fragment">Where as for <span class="math inline">\(n = 500\)</span>, with <span class="math inline">\(h_n = n ^ {-0.2}\)</span> we get similar results that we get with <span class="math inline">\(h_n = n ^ {-0.4} for n = 20\)</span></li>
<li class="fragment"><span class="math inline">\(nh_n\)</span> determines the rate of convergence of <span class="math inline">\(f_n(x) - f(x)\)</span> to asymptotic normality.</li>
</ul>
</div>
</section></section>
<section>
<section id="least-square-cross-validation" class="title-slide slide level1 center">
<h1>Least Square Cross Validation</h1>

</section>
<section id="looking-for-optimal-bandwidth" class="slide level2">
<h2>Looking for Optimal Bandwidth:</h2>
<p>As we saw in the previous sections, the kernel density estimator <span class="math inline">\(f_n\)</span> critically depends on the bandwidth employed. The purpose of this section is to introduce objective and automatic bandwidth selectors that attempt to minimize the estimation error of the target density <span class="math inline">\(f\)</span>. The first step is to define a global, rather than local, error criterion. The Integrated Squared Error (ISE), <span class="math display">\[ISE = \int_{-\infty}^{\infty}(f_n(x)-f(x))^2 dx\]</span> is the squared distance between the estimator and the target density. The ISE is a random quantity, since it depends directly on the sample <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span>. As a consequence, looking for an optimal bandwidth is a hard task, since the optimization is dependent on the sample itself and not only on the population and <span class="math inline">\(n\)</span>. To avoid this problem, it is usual to compute the Mean Integrated Squared Error (<span class="math inline">\(MISE = E(ISE)\)</span>). The MISE is convenient due to its mathematical tractability and its natural relation to the MSE. So we try to minimize MISE to obtain optimal h. To avoid the clear dependence on the sample, we do this evaluation in a cross-validatory way.</p>
</section>
<section id="mise" class="slide level2">
<h2>MISE</h2>
<p><span class="math display">\[MISE = E[\int_{-\infty}^{\infty}f_n^2(x)dx] - 2E[\int_{-\infty}^{\infty}f_n(x)f(x)dx] + \int_{-\infty}^{\infty}f^2(x)dx\]</span> We can ignore the last term as it does not depend on h. Ignoring the last term, the quantity is unknown, but it can be estimated unbiasedly by, <span class="math display">\[M_0(h_n)=\int_{-\infty}^{\infty}(f_n^2(x)dx-\frac{2}{n}\sum_{i=1}^{n}\hat{f}_{-i}(X_i)\]</span> w.r.t <span class="math inline">\(h_n\)</span>, where <span class="math inline">\(\hat{f}_{-i}(X_i)= \frac{1}{(n-1)h_n}\sum_{j=1, j\neq i}^{n}k\left(\frac{X_i-X_j}{h_n}\right)\)</span> There are various type of kernels and <span class="math inline">\(X_i\)</span>’s can be drawn from different distributions. For random samples drawn from each of the distributions <span class="math inline">\(N(0,1), Cauchy(0,1), Logistic(0,1)\)</span>, we can calculate optimal <span class="math inline">\(h_n\)</span> for the kernels Gaussian, Epanechnikov and Triangular. The following curves show how <span class="math inline">\(h_n\)</span> depends on n, and try to guess a value of p so that <span class="math inline">\(h_n \propto n^{-1/p}\)</span></p>
</section></section>
<section>
<section id="comparison-using-graphs" class="title-slide slide level1 center">
<h1>Comparison Using Graphs:</h1>

</section>
<section id="for-normal01-samples" class="slide level2">
<h2>For Normal(0,1) samples</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">150</span>,<span class="dv">800</span>,<span class="dv">50</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>znorm <span class="ot">&lt;-</span> n<span class="sc">^</span>(<span class="sc">-</span>.<span class="dv">24</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>gnorm <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="cf">for</span> (i <span class="cf">in</span> n){gnorm <span class="ot">&lt;-</span> <span class="fu">c</span>(gnorm,<span class="fu">crossval</span>(i,<span class="st">"gaussian"</span>,rnorm))}</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>enorm <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="cf">for</span> (i <span class="cf">in</span> n){enorm <span class="ot">&lt;-</span> <span class="fu">c</span>(enorm,<span class="fu">crossval</span>(i,<span class="st">"epanechnikov"</span>, rnorm))}</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>tnorm <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="cf">for</span> (i <span class="cf">in</span> n){tnorm <span class="ot">&lt;-</span> <span class="fu">c</span>(tnorm,<span class="fu">crossval</span>(i,<span class="st">"triangular"</span>, rnorm))}</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, gnorm), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> gnorm,<span class="at">color=</span><span class="st">"Gaussian"</span>))<span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, znorm), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> znorm,<span class="at">color=</span><span class="st">"f(n)"</span>))<span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, enorm), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> enorm,<span class="at">color=</span><span class="st">"Epanechnikov"</span>))<span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, tnorm), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> tnorm,<span class="at">color=</span><span class="st">"Triangular"</span>))<span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span><span class="st">"Kernel"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Gaussian"</span>, <span class="st">"Epanechnikov"</span>, <span class="st">"Triangular"</span>, </span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="st">"f(n)"</span>),<span class="at">values=</span><span class="fu">c</span>(<span class="at">Gaussian=</span><span class="st">"red"</span>, <span class="at">Epanechnikov=</span><span class="st">"blue"</span>, <span class="at">Triangular=</span><span class="st">"magenta"</span>, <span class="st">"f(n)"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="fu">xlab</span>(<span class="st">"Values of n"</span>) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>  <span class="fu">ylab</span>(<span class="st">"Values of optimal h_n"</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="fu">ggtitle</span>(<span class="st">"Comparing Optimal h_n for various kernel, when sample is from N(0,1)"</span>)</span>
<span id="cb5-22"><a href="#cb5-22"></a>fig1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="for-cauchy01-samples" class="slide level2">
<h2>For Cauchy(0,1) samples</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">150</span>,<span class="dv">800</span>,<span class="dv">50</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>zcau <span class="ot">&lt;-</span> n<span class="sc">^</span>(<span class="sc">-</span>.<span class="dv">15</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a>gcau <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="cf">for</span> (i <span class="cf">in</span> n){gcau <span class="ot">&lt;-</span> <span class="fu">c</span>(gcau,<span class="fu">crossval</span>(i,<span class="st">"gaussian"</span>,rcauchy))}</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>ecau <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="cf">for</span> (i <span class="cf">in</span> n){ecau <span class="ot">&lt;-</span> <span class="fu">c</span>(ecau,<span class="fu">crossval</span>(i,<span class="st">"epanechnikov"</span>,rcauchy))}</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>tcau <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="cf">for</span> (i <span class="cf">in</span> n){tcau <span class="ot">&lt;-</span> <span class="fu">c</span>(tcau,<span class="fu">crossval</span>(i,<span class="st">"triangular"</span>,rcauchy))}</span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, gcau), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> gcau,<span class="at">color=</span><span class="st">"Gaussian"</span>))<span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, zcau), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> zcau,<span class="at">color=</span><span class="st">"f(n)"</span>))<span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, ecau), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> ecau,<span class="at">color=</span><span class="st">"Epanechnikov"</span>))<span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, tcau), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> tcau,<span class="at">color=</span><span class="st">"Triangular"</span>))<span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span><span class="st">"Kernel"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Gaussian"</span>, <span class="st">"Epanechnikov"</span>, <span class="st">"Triangular"</span>, <span class="st">"f(n)"</span>),<span class="at">values=</span><span class="fu">c</span>(<span class="at">Gaussian=</span><span class="st">"red"</span>, <span class="at">Epanechnikov=</span><span class="st">"blue"</span>, <span class="at">Triangular=</span><span class="st">"magenta"</span>, <span class="st">"f(n)"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="fu">xlab</span>(<span class="st">"Values of n"</span>) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>  <span class="fu">ylab</span>(<span class="st">"Values of optimal h_n"</span>) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">ggtitle</span>(<span class="st">"Comparing Optimal h_n for various kernel, when sample is from Cauchy(0,1)"</span>)</span>
<span id="cb6-21"><a href="#cb6-21"></a>fig2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch"></section>
<section id="for-logistic01-samples" class="slide level2">
<h2>For Logistic(0,1) samples</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">150</span>,<span class="dv">800</span>,<span class="dv">50</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>zlog <span class="ot">&lt;-</span> n<span class="sc">^</span>(<span class="sc">-</span>.<span class="dv">18</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a>glog <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="cf">for</span> (i <span class="cf">in</span> n){glog <span class="ot">&lt;-</span> <span class="fu">c</span>(glog,<span class="fu">crossval</span>(i,<span class="st">"gaussian"</span>,rlogis))}</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a>elog <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="cf">for</span> (i <span class="cf">in</span> n){elog <span class="ot">&lt;-</span> <span class="fu">c</span>(elog,<span class="fu">crossval</span>(i,<span class="st">"epanechnikov"</span>,rlogis))}</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>tlog <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="cf">for</span> (i <span class="cf">in</span> n){tlog <span class="ot">&lt;-</span> <span class="fu">c</span>(tlog,<span class="fu">crossval</span>(i,<span class="st">"triangular"</span>,rlogis))}</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a>fig3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, glog), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> glog,<span class="at">color=</span><span class="st">"Gaussian"</span>))<span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, zlog), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> zlog,<span class="at">color=</span><span class="st">"f(n)"</span>))<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, elog), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> elog,<span class="at">color=</span><span class="st">"Epanechnikov"</span>))<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(n, tlog), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> tlog,<span class="at">color=</span><span class="st">"Triangular"</span>))<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span><span class="st">"Kernel"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Gaussian"</span>, <span class="st">"Epanechnikov"</span>, <span class="st">"Triangular"</span>, </span>
<span id="cb7-18"><a href="#cb7-18"></a>                                              <span class="st">"f(n)"</span>),<span class="at">values=</span><span class="fu">c</span>(<span class="at">Gaussian=</span><span class="st">"red"</span>, <span class="at">Epanechnikov=</span><span class="st">"blue"</span>, <span class="at">Triangular=</span><span class="st">"magenta"</span>, <span class="st">"f(n)"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="fu">xlab</span>(<span class="st">"Values of n"</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="fu">ylab</span>(<span class="st">"Values of optimal h_n"</span>) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>  <span class="fu">ggtitle</span>(<span class="st">"Comparing Optimal h_n for various kernel, when sample is from logistic(0,1)"</span>)</span>
<span id="cb7-22"><a href="#cb7-22"></a>fig3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="observations-1" class="slide level2">
<h2>Observations</h2>
<p>The graphs show that,</p>
<ul>
<li class="fragment"><p>In case of Normal samples, the optimal <span class="math inline">\(h_n\)</span> for different kernels is close to <span class="math inline">\(n^{-0.24}\)</span> when n is large enough.</p></li>
<li class="fragment"><p>In case of cauchy samples, the optimal <span class="math inline">\(h_n\)</span> for different kernels is close to <span class="math inline">\(n^{-0.15}\)</span> when n is large enough.</p></li>
<li class="fragment"><p>In case of logistic samples, the optimal <span class="math inline">\(h_n\)</span> for different kernels is close to <span class="math inline">\(n^{-0.18}\)</span> when n is large enough.</p></li>
</ul>
</section></section>
<section>
<section id="checking-asymptotic-normality-of-density-estimator-for-upper-quantiles-using-optimal-values-of-bandwidth" class="title-slide slide level1 center">
<h1>Checking Asymptotic Normality of density estimator for upper quantiles using optimal values of bandwidth</h1>

</section>
<section class="slide level2">

<h3 id="using-gaussian-kernel-for-samples-from-n01">using “Gaussian Kernel” for samples from N(0,1)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Define the kernel functions</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>gaussian_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">dnorm</span>(u)</span>
<span id="cb8-5"><a href="#cb8-5"></a>logistic_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">dlogis</span>(u)</span>
<span id="cb8-6"><a href="#cb8-6"></a>naive_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">ifelse</span>(<span class="fu">abs</span>(u) <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>tricube_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">ifelse</span>(<span class="fu">abs</span>(u) <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">35</span><span class="sc">/</span><span class="dv">32</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(u)<span class="sc">^</span><span class="dv">3</span>)<span class="sc">^</span><span class="dv">3</span>, <span class="dv">0</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>cosine_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">ifelse</span>(<span class="fu">abs</span>(u) <span class="sc">&lt;=</span> <span class="dv">1</span>, pi<span class="sc">/</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">cos</span>(pi<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> u), <span class="dv">0</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>epanechnikov_kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="fu">ifelse</span>(<span class="fu">abs</span>(u) <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> u<span class="sc">^</span><span class="dv">2</span>), <span class="dv">0</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># Set the values for n and calculate h_n for each</span></span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a>n_values <span class="ot">&lt;-</span> n[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">14</span>)]</span>
<span id="cb8-14"><a href="#cb8-14"></a>h_values <span class="ot">&lt;-</span> gnorm[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">14</span>)]</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># Function to simulate and plot for a given kernel</span></span>
<span id="cb8-17"><a href="#cb8-17"></a></span>
<span id="cb8-18"><a href="#cb8-18"></a>simulate_and_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(kernel_func, kernel_name, quantile) {</span>
<span id="cb8-19"><a href="#cb8-19"></a>  p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-20"><a href="#cb8-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n_values))) {</span>
<span id="cb8-21"><a href="#cb8-21"></a>    n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb8-22"><a href="#cb8-22"></a>    h <span class="ot">&lt;-</span> h_values[i]</span>
<span id="cb8-23"><a href="#cb8-23"></a>    </span>
<span id="cb8-24"><a href="#cb8-24"></a>    <span class="co"># Generate random samples</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>    </span>
<span id="cb8-26"><a href="#cb8-26"></a>    </span>
<span id="cb8-27"><a href="#cb8-27"></a>    <span class="co"># Compute the 0.1 quantile of the sample</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>    x_q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(quantile, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-29"><a href="#cb8-29"></a>    </span>
<span id="cb8-30"><a href="#cb8-30"></a>    <span class="co"># For each sample, estimate the density at x_q using the kernel function</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>    f_n_x <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, {</span>
<span id="cb8-32"><a href="#cb8-32"></a>      sample_x_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)          <span class="co"># New sample for each replication</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>      <span class="fu">mean</span>(<span class="fu">kernel_func</span>((x_q <span class="sc">-</span> sample_x_i) <span class="sc">/</span> h)) <span class="sc">/</span> h</span>
<span id="cb8-34"><a href="#cb8-34"></a>    })</span>
<span id="cb8-35"><a href="#cb8-35"></a>    </span>
<span id="cb8-36"><a href="#cb8-36"></a>    </span>
<span id="cb8-37"><a href="#cb8-37"></a>    df<span class="ot">&lt;-</span><span class="fu">D</span>(<span class="fu">D</span>(<span class="fu">expression</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)),<span class="st">"x"</span>),<span class="st">"x"</span>)</span>
<span id="cb8-38"><a href="#cb8-38"></a>    <span class="fu">mode</span>(df)</span>
<span id="cb8-39"><a href="#cb8-39"></a>    x<span class="ot">&lt;-</span>x_q</span>
<span id="cb8-40"><a href="#cb8-40"></a>    E_f_n_x <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_q,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> h<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">eval</span>(df))</span>
<span id="cb8-41"><a href="#cb8-41"></a>    kernel_int <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) <span class="fu">kernel_func</span>(u)<span class="sc">^</span><span class="dv">2</span>, <span class="at">lower =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb8-42"><a href="#cb8-42"></a>    var_f_n_x <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> (n <span class="sc">*</span> h)) <span class="sc">*</span> <span class="fu">dnorm</span>(x_q,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">*</span> kernel_int</span>
<span id="cb8-43"><a href="#cb8-43"></a>    </span>
<span id="cb8-44"><a href="#cb8-44"></a>    <span class="co"># Standardize f_n(x)</span></span>
<span id="cb8-45"><a href="#cb8-45"></a>    standardized_f_n_x <span class="ot">&lt;-</span> (f_n_x<span class="sc">-</span>E_f_n_x)<span class="sc">/</span><span class="fu">sqrt</span>( var_f_n_x)</span>
<span id="cb8-46"><a href="#cb8-46"></a>    </span>
<span id="cb8-47"><a href="#cb8-47"></a>    <span class="co"># Create a dataframe for plotting</span></span>
<span id="cb8-48"><a href="#cb8-48"></a>    data_to_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">standardized_f_n_x =</span> standardized_f_n_x)</span>
<span id="cb8-49"><a href="#cb8-49"></a>    </span>
<span id="cb8-50"><a href="#cb8-50"></a>    <span class="co"># Plot the histogram with the density of N(0,1) overlaid</span></span>
<span id="cb8-51"><a href="#cb8-51"></a>    </span>
<span id="cb8-52"><a href="#cb8-52"></a>    </span>
<span id="cb8-53"><a href="#cb8-53"></a>    p[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_to_plot, <span class="fu">aes</span>(<span class="at">x =</span> standardized_f_n_x)) <span class="sc">+</span></span>
<span id="cb8-54"><a href="#cb8-54"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb8-55"><a href="#cb8-55"></a>      <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-56"><a href="#cb8-56"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Quantile="</span>, <span class="fl">0.5</span> <span class="sc">+</span> (<span class="fl">0.9</span><span class="sc">-</span>quantile), <span class="st">"|n ="</span>, n),</span>
<span id="cb8-57"><a href="#cb8-57"></a>           <span class="at">x =</span> <span class="st">"Standardized f_n(x_q)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb8-58"><a href="#cb8-58"></a>    </span>
<span id="cb8-59"><a href="#cb8-59"></a>  }</span>
<span id="cb8-60"><a href="#cb8-60"></a>  <span class="fu">return</span>(p)</span>
<span id="cb8-61"><a href="#cb8-61"></a>}</span>
<span id="cb8-62"><a href="#cb8-62"></a></span>
<span id="cb8-63"><a href="#cb8-63"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> <span class="fu">c</span>(<span class="fu">simulate_and_plot</span>(gaussian_kernel, <span class="st">"Gaussian"</span>, <span class="fl">0.9</span>),</span>
<span id="cb8-64"><a href="#cb8-64"></a>                             <span class="fu">simulate_and_plot</span>(gaussian_kernel, <span class="st">"Gaussian"</span>, <span class="fl">0.75</span>),</span>
<span id="cb8-65"><a href="#cb8-65"></a>                             <span class="fu">simulate_and_plot</span>(gaussian_kernel, <span class="st">"Gaussian"</span>, <span class="fl">0.6</span>),</span>
<span id="cb8-66"><a href="#cb8-66"></a>                             <span class="fu">simulate_and_plot</span>(gaussian_kernel, <span class="st">"Gaussian"</span>, <span class="fl">0.5</span>)),<span class="at">nrow =</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<h3 id="using-epanechnikov-kernel-for-samples-from-n01">using “Epanechnikov Kernel” for samples from N(0,1)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>n_values <span class="ot">&lt;-</span> n[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">14</span>)]</span>
<span id="cb9-2"><a href="#cb9-2"></a>h_values <span class="ot">&lt;-</span> enorm[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">14</span>)]</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Function to simulate and plot for a given kernel</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>simulate_and_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(kernel_func, kernel_name, quantile) {</span>
<span id="cb9-7"><a href="#cb9-7"></a>  p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n_values))) {</span>
<span id="cb9-9"><a href="#cb9-9"></a>    n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb9-10"><a href="#cb9-10"></a>    h <span class="ot">&lt;-</span> h_values[i]</span>
<span id="cb9-11"><a href="#cb9-11"></a>    </span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="co"># Generate random samples</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>    </span>
<span id="cb9-14"><a href="#cb9-14"></a>    </span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="co"># Compute the 0.1 quantile of the sample</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>    x_q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(quantile, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb9-17"><a href="#cb9-17"></a>    </span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="co"># For each sample, estimate the density at x_q using the kernel function</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    f_n_x <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, {</span>
<span id="cb9-20"><a href="#cb9-20"></a>      sample_x_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)          <span class="co"># New sample for each replication</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>      <span class="fu">mean</span>(<span class="fu">kernel_func</span>((x_q <span class="sc">-</span> sample_x_i) <span class="sc">/</span> h)) <span class="sc">/</span> h</span>
<span id="cb9-22"><a href="#cb9-22"></a>    })</span>
<span id="cb9-23"><a href="#cb9-23"></a>    </span>
<span id="cb9-24"><a href="#cb9-24"></a>    </span>
<span id="cb9-25"><a href="#cb9-25"></a>    df<span class="ot">&lt;-</span><span class="fu">D</span>(<span class="fu">D</span>(<span class="fu">expression</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)),<span class="st">"x"</span>),<span class="st">"x"</span>)</span>
<span id="cb9-26"><a href="#cb9-26"></a>    <span class="fu">mode</span>(df)</span>
<span id="cb9-27"><a href="#cb9-27"></a>    x<span class="ot">&lt;-</span>x_q</span>
<span id="cb9-28"><a href="#cb9-28"></a>    E_f_n_x <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_q,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span> (<span class="fl">0.5</span> <span class="sc">*</span> h<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">eval</span>(df))</span>
<span id="cb9-29"><a href="#cb9-29"></a>    kernel_int <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) <span class="fu">kernel_func</span>(u)<span class="sc">^</span><span class="dv">2</span>, <span class="at">lower =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb9-30"><a href="#cb9-30"></a>    var_f_n_x <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> (n <span class="sc">*</span> h)) <span class="sc">*</span> <span class="fu">dnorm</span>(x_q,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">*</span> kernel_int</span>
<span id="cb9-31"><a href="#cb9-31"></a>    </span>
<span id="cb9-32"><a href="#cb9-32"></a>    <span class="co"># Standardize f_n(x)</span></span>
<span id="cb9-33"><a href="#cb9-33"></a>    standardized_f_n_x <span class="ot">&lt;-</span> (f_n_x<span class="sc">-</span>E_f_n_x)<span class="sc">/</span><span class="fu">sqrt</span>( var_f_n_x)</span>
<span id="cb9-34"><a href="#cb9-34"></a>    </span>
<span id="cb9-35"><a href="#cb9-35"></a>    <span class="co"># Create a dataframe for plotting</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>    data_to_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">standardized_f_n_x =</span> standardized_f_n_x)</span>
<span id="cb9-37"><a href="#cb9-37"></a>    </span>
<span id="cb9-38"><a href="#cb9-38"></a>    <span class="co"># Plot the histogram with the density of N(0,1) overlaid</span></span>
<span id="cb9-39"><a href="#cb9-39"></a>    </span>
<span id="cb9-40"><a href="#cb9-40"></a>    </span>
<span id="cb9-41"><a href="#cb9-41"></a>    p[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_to_plot, <span class="fu">aes</span>(<span class="at">x =</span> standardized_f_n_x)) <span class="sc">+</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb9-43"><a href="#cb9-43"></a>      <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-44"><a href="#cb9-44"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Quantile="</span>, <span class="fl">0.5</span> <span class="sc">+</span> (<span class="fl">0.9</span><span class="sc">-</span>quantile), <span class="st">"|n ="</span>, n),</span>
<span id="cb9-45"><a href="#cb9-45"></a>           <span class="at">x =</span> <span class="st">"Standardized f_n(x_q)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb9-46"><a href="#cb9-46"></a>    </span>
<span id="cb9-47"><a href="#cb9-47"></a>  }</span>
<span id="cb9-48"><a href="#cb9-48"></a>  <span class="fu">return</span>(p)</span>
<span id="cb9-49"><a href="#cb9-49"></a>}</span>
<span id="cb9-50"><a href="#cb9-50"></a></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> <span class="fu">c</span>(<span class="fu">simulate_and_plot</span>(epanechnikov_kernel, <span class="st">"epanechnikov"</span>, <span class="fl">0.9</span>),</span>
<span id="cb9-52"><a href="#cb9-52"></a>                             <span class="fu">simulate_and_plot</span>(epanechnikov_kernel, <span class="st">"epanechnikov"</span>, <span class="fl">0.75</span>),</span>
<span id="cb9-53"><a href="#cb9-53"></a>                             <span class="fu">simulate_and_plot</span>(epanechnikov_kernel, <span class="st">"epanechnikov"</span>, <span class="fl">0.6</span>),</span>
<span id="cb9-54"><a href="#cb9-54"></a>                             <span class="fu">simulate_and_plot</span>(epanechnikov_kernel, <span class="st">"epanechnikov"</span>, <span class="fl">0.5</span>)),<span class="at">nrow =</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="density_estimation--2-_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<h3 id="comments-1">Comments:</h3>
<ul>
<li class="fragment"><p>From previous two graphs we observe that the density estimates have improved for using optimal <span class="math inline">\(h_n\)</span> than the estimates used during observing pointwise convergence before.</p></li>
<li class="fragment"><p>For large and even for small <span class="math inline">\(n\)</span> the estimates are obviously better.</p></li>
<li class="fragment"><p>Among the Kernels <em>Gaussian</em> and <em>Epanechnikov</em>, second one performed better in this case, even for the upper quantiles also.</p></li>
</ul>
</section>
<section class="slide level2">

</section></section>
<section id="thank-you" class="title-slide slide level1 center">
<h1>THANK YOU :))</h1>

<img src="logo.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Indian Statistical Institute, Delhi</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="density_estimation (2)_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="density_estimation (2)_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="density_estimation (2)_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="density_estimation (2)_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>